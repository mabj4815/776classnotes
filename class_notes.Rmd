---
title: "Class_Notes"
author: "MATEO BANDALA-JACQUES"
date: "2024-08-29"
output: html_document
---

```{r setup, include=FALSE}
library(reprex)
library(here)
library(tidyverse)
library(ggthemes)
library(bbplot)
library(ThemePark)
library(plotly)
library(colorblindr)

#remotes::install_github("clauswilke/colorblindr")

```

## Class notes for 2024-08-29

```{r cars}



print("hello world")


# reprex() will create a reproducible example of whatever is copied to the clipboard



here()
```


## Class notes for 2024-09-05

```{r}

#Let's create a tibble :) 


chicago <- readRDS(here("data", "chicago.rds"))
chicago <- as.tibble(chicago)

as.tibble(chicago) %>%
  print(n=30, width=Inf)

chicago$year <- lubridate::year(chicago$date)

chicago <- chicago %>%
  mutate(
    season = case_when(
      month(date) %in% c(12, 1, 2) ~ "Winter",
      month(date) %in% c(3, 4, 5) ~ "Spring",
      month(date) %in% c(6, 7, 8) ~ "Summer",
      month(date) %in% c(9, 10, 11) ~ "Fall"
    )
  )

chicago %>%
  ggplot(aes(x=date, y=tmpd, color=as.factor(season))) +
  geom_point() +
  labs(x="Date", y="Temperature, F", color="Season") +
  theme_minimal()

 glimpse(chicago)


tibble(
  a=1:5,
  b=6:10,
  c=1L
)

#Non-selecting some columns
chicago %>%
  select(-(city:dptp))


#And the equivalent using base R
i <- match("city", names(chicago))
j <- match("dptp", names(chicago))
head(chicago[, -(i:j)])




#Transmute drops all non-mutate variables


chicago %>%
  transmute(temp_c = (tmpd - 32) * 5 / 9)

chicago <- chicago %>%
  mutate(temp_c = (tmpd - 32) * 5 / 9)

chicago %>%
  group_by(year) %>%
  summarise(pm25 = mean(pm25tmean2, na.rm=TRUE),
            o3 = mean(o3tmean2, na.rm = TRUE),
            celsius = mean(temp_c, na.rm=TRUE))


# slice_sample shows a random subster of rows
set.seed(8963119)

chicago %>%
  slice_sample(n=5)
  


relig_income


relig_income %>%
  pivot_longer(-religion, names_to = "income", values_to = "response")






```

## Class notes for 2024-09-10

```{r notes 2024-09-10}


outcomes <- tibble(
  id = rep(c("a", "b", "c"), each=3),
  visit = rep(0:2,3),
  outcome = rnorm(3*3,3)
)


outcomes


subjects <- tibble(
  id = c("a", "b", "c"),
  house = c("detached", "rowhouse", "rowhouse")
)


subjects


left_join(outcomes, subjects, by="id")
 

full_join(outcomes, subjects, by="id")

inner_join(outcomes, subjects, by="id")


 
subjects <- tibble(
    id = c("b", "c"),
    visit = c(1, 0),
    house = c("rowhouse", "rowhouse"),
)

subjects



left_join(outcomes, subjects, by=c("id", "visit"))
 full_join(outcomes, subjects,  by=c("id", "visit"))
inner_join(outcomes, subjects,  by=c("id", "visit"))




semi_join(outcomes, subjects,  by=c("id", "visit"))
anti_join(outcomes, subjects,  by=c("id", "visit"))


```


``` {r ggplot stuff}

here()


maacs <- read_csv(here("data", "bmi_pm25_no2_sim.csv"),
    col_types = "nnci"
)

maacs

maacs %>%
  ggplot(aes(x=logpm25, y=NocturnalSympt)) +
  geom_point(aes(color=bmicat), alpha =10) +
  geom_smooth(method = "loess")+
  theme_stata(base_size = 20)




library(palmerpenguins)
library(bbplot)

penguins %>%
  ggplot(aes(x=flipper_length_mm, y=bill_length_mm, color=species)) +
  geom_point() +
  geom_smooth(method="glm") +
  labs(x=expression("Flipper lenght "[a]), y="Bill length", color="Species") +
  scale_x_continuous() +
  coord_cartesian(xlim=c(170,200))+ #This is a crop, not a true filter
  theme_bw()

  
  penguins %>%
  ggplot(aes(x=flipper_length_mm, y=bill_length_mm, color=species)) +
  geom_point() +
  geom_smooth(method="glm") +
  bbplot::bbc_style() + 
    labs(x=expression("Flipper lenght "[a]), y="Bill length", color="Species",
         title = "Penguins", subtitle = "Marica") 

  
g<-  penguins %>%
  ggplot(aes(x=flipper_length_mm, y=bill_length_mm, color=species)) +
  geom_point() +
  geom_smooth(method="glm") +
  theme_starwars()+
    labs(x=expression("Flipper lenght "[a]), y="Bill length", color="Species",
         title = "Penguins") 


    #Make it interactive
g<-  penguins %>%
  ggplot(aes(x=flipper_length_mm, y=bill_length_mm, color=species)) +
  geom_point() +
  geom_smooth(method="glm") +
  theme_starwars()+
    labs(x="FLipper length", y="Bill length", color="Species",
         title = "Penguins") 

plotly::ggplotly(g)



g<-  penguins %>%
  ggplot(aes(x=flipper_length_mm, y=bill_length_mm, color=species)) +
  geom_point() +
  geom_smooth(method="glm") +
    labs(x="FLipper length", y="Bill length", color="Species",
         title = "Penguins") 

colorblindr::cvd_grid(g)

```
## Class notes for 2024-09-17
```{r nuts and bolts}


x <- c("hola", seq(0,25,by=5), "gonorrhea")

class(x)

x


-15:15
for(i in x){
  print(x)
}


#Create an empty vector
vector(mode="numeric", length=4)
vector(mode="character", length=4)

#Create a non-empty vector

x <- c(0.5, 0.6) #numeric vector
x <- c(TRUE, FALSE) #logical vector
x <- c("a", "b") #character vector
x <- c(1+0i, 2+4i) #complex vector

#Atomic vectors can only contain objects of the same type/class
class(x)

# The exception is list: they allow you to have different classes of objects, and can be recursive

#Atomic vectors are homosexual, wile lists  can be heterosexual
list_object <-  list(1.5, "camila")
list_object

#If we do it with the c() function, it forces the 1.5 to be character, since vectors have to be the same class
class (c(1.5, "camila"))
class(list_object)



typeof(4) #Doubles are approximations
typeof(4L)



x <- sqrt(2)^2
x
x-2


letters
typeof(letters)
length(letters)
dim(letters)
typeof(letters)




typeof(c(TRUE,2))
typeof(c("a",TRUE))


#Explicit coercion
x <- 0:6
class(x)

as.numeric(x) #Stores as double
as.integer(x) #Stores as integer (better if no decimals)
as.logical(x) #1=TRUE, else = FALSE

#Sometimes R can't figure it out

x <- c("a", "b", "c")
as.numeric(x)


#Matrices

#matrixes are vectors with an extra dimension  :O

m <- matrix(nrow=2, ncol=3)
m

dim(m)

attributes(m)

#Matrices are constructed column-wise, starting top left


m <- matrix(1:6, nrow=2, ncol=3)
m



m <- matrix(c("Camila", "Restrepo", "Colombia", 
              "Mateo", "Jacques", "Mexico"),
            nrow=2, ncol=3, byrow = TRUE)

m



colnames(m) <- c("Nombre", "Apellido", "PÃ¡is")

m

as_tibble(m)

#Factors are objects that help us represent categories

x <- factor(c("yes", "no", "no", "yes", "yes"))
print(x)

table(x)



attributes(x)



x <- c(0,1,2,0,1,2,1,2,1,2,1,0,0)
x <- factor(x, levels = c(0,1,2), labels = c("No", "Yes", "Maybe"))
x
table(x)


x <- c(0,1,2,0,1,2,1,2,1,2,1,0,0)
x <- factor(x, levels = c(2,1,0), labels = c("Maybe", "Yes", "No"))
x
table(x)







#Dataframe

t <- tibble(
  Name = c("Camila", "Mateo", "Mitali"),
  Last_Name = c("Restrepo", "Jacques", "Joshi"),
  SSN = c(209568839,590204881,290652118)
)


t

```

#Notes for 2024-09-19

```{r}


x <- 3



if(x==3){
  print("Hi")
}


if (x==2){
  print("X = 2")
}else{
  print("X is not 2")
}


y <- ifelse(x==3, "It's 3", "Not 3")
y




for(i in 1:10){
  print(i)
}

x <- c("a", "b", "c", "d")

for (i in 1:4){
  print(i)
}


seq_along(x)

for (i in seq_along(x)) {
  print(i)
}

for (i in seq_along(x)) {
  print(i)
}


for (babyshark in x){
  print(babyshark)
}




#While

x <- 0 

while (x < 10){
  print(x)
  x <- x+1
  
}


#Next, and break
 for (i in 1:200){
   if (i <=20){
     ## skip the first 20 iterations
     next
   }
   print (i)
 }



#Next, and break
 for (i in 1:200){
   if (i >20){
     ## skip the first 20 iterations

   print (i)
   }}





#FUNCTIONS


f <- function(num){
  for (i in seq_len(num)){
    cat("Hello, world!\n")
  }
}


f(5)

```


## Notes for 2024-09-24
```{r}

inches <- c(69,62,66,70,70,73,67,73,67,70)

#if we wants to convert to centimeters:
inches

inches*2.54 #Each element is multiplied by 2.54

#Two vectors with the same length can be added


x<- 1:10
y <- 1:10


x+y


#that is, we don't need to write a for loop for thios




#' Title
#'
#' @param a 
#' @param b 
#'
#' @return
#' @export
#'
#' @examples
#' ##Let's show how to use my function
#' 
#'
my_sum <- function(a,b){
  if(length(a)!=length(b)){ stop("Vectors must be same length")}
  a+b
    c<-a+b
  print(c)
}



y <- 1:10
my_sum(x,y)


library(purrr)

purrr::map2_int(x,y, my_sum)



x<- list(a = 1:5, b=rnorm(10))
x


lapply(x, mean) # Output is a list

#or

map_dbl(x, mean) #Output is a vector




x <- c(rnorm(10), runif(10), rnorm(10,1))
x

f <- gl(3,10)
f


split(x,f)


lapply(split(x,f),mean)


#Splitting a data frame

library("datasets")
head(airquality)

#We can split de data by month

s<- split(airquality, airquality$Month)
str(s)


lapply(s, function(x) {
    colMeans(x[, c("Ozone", "Solar.R", "Wind")], na.rm = TRUE)
})

sapply(s, function(x) {
    colMeans(x[, c("Ozone", "Solar.R", "Wind")], na.rm = TRUE)
})


```

# *This is an example of addition of text*

## **This is an example of addition of text**

# ***This is an example of addition of text***


